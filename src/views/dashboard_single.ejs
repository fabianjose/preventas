
  <%- include ('partials/header')  %>


            <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
            <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
          

            <div class="container row">
            
               <h2>Campaña: <%- JSON.stringify(usuario) %></h2>
               <p><%- JSON.stringify(data_hogar) %></p>
                <p><%- JSON.stringify(hijos) %></p>
              <h2>Estadística del mes: <%= mes+1 %></h2>
              <% if( usuario.rol  = 2 ){ %>
              <label>Usuarios</label>
              <select>
                 <option>Todos</option>
                <% hijos.forEach(hijo =>  { %>
                    <option value="<%- hijo.id %>"><%=  hijo.nombre %></option>
                <% }) %>
              </select>
              <%
                }
              %>
           <div class="col-md-4 text-center">
            <h4>Hogar</h4>
            <canvas  id="myChartHogar" width="400" height="300"></canvas></div>
            <div class="col-md-4 text-center">
            <h4>Pyme</h4><canvas  id="myChartPyme" width="400" height="300"></canvas></div>
            <div class="col-md-4 text-center">
            <h4>Avanzado</h4> <canvas  id="myChartAvanzado" width="400" height="300"></canvas></div>
            <div>
           <div class="row mt-4">
            <div class="col-md-4 text-center">
              <h4>Ventas Mensuales</h4>
            <canvas id="myChart" width="400" height="400"></canvas>
            </div>
           </div>
<script>

var data
$.get("/estadistica/1", a =>{
    meses = a.ventas.map(m =>{
     return m.reduce((ac, v)=>{ return ac + v.reduce((acu, u)=>{ return acu +  u },0) },0)
    })
   meta_hogar = a.metas[<%= mes %>][1]
   meta_lograda = a.ventas[<%= mes %>][1][3]
   meta_en_proceso = a.ventas[<%= mes %>][1][1]
   meta_en_proceso -= meta_lograda
   meta_hogar = meta_hogar - meta_lograda - meta_en_proceso
    var ctx = document.getElementById('myChart').getContext('2d');
var myChart = new Chart(ctx, {
    type: 'radar',
    data: {
        labels: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'],
        datasets: [{
            label: 'Ventas',
            data: meses,
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)',
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)',
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero: true
                }
            }]
        }
    }
});

var ctx = document.getElementById('myChartHogar').getContext('2d');

var myChart = new Chart(ctx, {
     type: 'doughnut',
    data: {
        labels: ['Cerrado Ganado', 'Agendado', 'Meta'],
        datasets: [{
            label: 'Hogar',
            data: [meta_lograda,meta_en_proceso ,meta_hogar],
            backgroundColor: [
                'rgba(0, 255, 50, 0.9)',
                'rgba(0, 255, 50, 0.5)',
                'rgba(255, 255,255, 0.2)'
                
            ],
            borderColor: [
               'rgba(0, 255, 50,1)',
                   'rgba(0, 255, 50,1)',
   'rgba(0, 255, 50, 1)'
               
            ],
            borderWidth: 1
        }]
    },
  options:{
    circumference:  Math.PI,
    rotation : -Math.PI 
  }
    
});




})

</script>
          </div>
<script>

var ctx1 = document.getElementById('myChartPyme').getContext('2d');
var ctx2 = document.getElementById('myChartAvanzado').getContext('2d');

var myChart1 = new Chart(ctx1, {
     type: 'doughnut',
    data: {
        labels: ['Cerrado Ganado', 'Agendado', 'Meta'],
        datasets: [{
            label: 'Pyme',
            data: [12, 15, 20],
            backgroundColor: [
                'rgba(0, 50, 255, 0.9)',
                'rgba(0, 50, 255, 0.5)',
                'rgba(255, 255,255, 0.2)'
                
            ],
            borderColor: [
                'rgba(0, 50, 255, 0.7)',
                  'rgba(0, 50, 255, 0.7)',
  'rgba(0, 50, 255, 0.7)'
               
            ],
            borderWidth: 1
        }]
    },
  options:{
    circumference:  Math.PI,
    rotation : -Math.PI 
  }
    
});
var myChart2 = new Chart(ctx2, {
     type: 'doughnut',
    data: {
        labels: ['Cerrado Ganado', 'Agendado', 'Meta'],
        datasets: [{
            label: 'Avanzado',
            data: [12, 15, 20],
            backgroundColor: [
                'rgba(255, 50, 0, 0.9)',
                'rgba(255, 50, 0, 0.5)',
                'rgba(255, 255,255, 0.2)'
                
            ],
            borderColor: [
                'rgba(255, 50, 0, 0.8)',
                  'rgba(255, 50, 0, 0.8)',
  'rgba(255, 50, 0, 0.8)'
               
            ],
            borderWidth: 1
        }]
    },
 
    
});
</script>

            <div class="row">
              <div class="col col-sm-6">
               <code> <%- JSON.stringify(datos) %></code>       
            </div>


            
       
 
 <%- include('partials/footer') %>