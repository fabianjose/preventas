 <%- include ('partials/header')  %>
       
<div class="container mt-4">


<h2>META</h2>

<form class="row">
<div class="col-md-5 mb-4">
	<div class="form-group">
		<label>Nombre: </label>
		<input class="form-control" type="text" name="" value="<%= meta.descripcion %>">
		<input type="hidden" name="meta" value="<%= meta.id %>">
	</div>
	<div class="form-group">
		<label>Monto: </label>
		<input class="form-control" type="text" name="" value="<%= meta.tarifa %>">
	</div>
</div>
<div class="col-md-5">
	<div class="form-group">
		<label>Mes: </label>
		<input class="form-control" type="text" name="" value="<%= meta.mes %>">
	</div>
	<div class="form-group">
		<label>Año: </label>
		<input class="form-control" type="text" name="" value="<%= meta.año %>">
	</div>
</div>
</form>
<hr>
<h2>Asignar usuarios a <%= meta.descripcion %> [<%= meta.mes+1 %>/<%= meta.año %> ] </h2>

<form class="row" method="post">
	<div class="col-md-5">
		<label>Usuarios</label>
		<select name="usuarios" id="select-usuarios" class="custom-select  form-control" multiple="">
			   <% users.forEach(function(user){ %>
			   <option value="<%= user.id %>" ><%= user.nombre %></option>
			   <% }); %>
		</select>
		<input type="hidden" name="meta" value="<%= meta.id %>">
	</div>
	<div class="col-md-2 h-100 text-center">
		<a class="btn btn-primary m-2 w-100 mt-5  btn-asigna">
			ASIGNAR >>
		</a>
		<a   class="btn btn-danger w-100 m-2 btn-quita">
			 << QUITAR META 
		</a>
	</div>

	<div class="col-md-5">
		<label>Usuarios Asinados a esta meta</label>

		<select id="seleccionados"  class="custom-select form-control"  multiple="">
			<% usuariosAgregados.forEach(function(user){ %>
			   <option value="<%= user.idMeta %>" ><%=user.nombre%></option>
			   <% }); %>
		</select>
	</div>
</form>

</div>                        
<script type="text/javascript">

$(".btn-asigna").click(e =>{
	e.preventDefault()
	alert("asignar ")
	valores = $("#select-usuarios").val()
	$.post("/asignaMeta/<%= meta.id %>",{usuarios: valores, meta:  '<%= meta.id %>' },
		e=>{
			location.reload()
		}
	)
})
$(".btn-quita").click(e=>{
	e.preventDefault()
	alert($("#seleccionados").val())
	id = $("#seleccionados").val()
	$.post("/desasignaMeta",{id:id},data=>{
		if(data == "ok")location.reload()
	})
})
</script>
 <%- include('partials/footer') %>